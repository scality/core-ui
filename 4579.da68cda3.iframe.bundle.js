/*! For license information please see 4579.da68cda3.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_scality_core_ui=self.webpackChunk_scality_core_ui||[]).push([[4579],{"./src/lib/components/linetemporalchart/tooltip/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CI:()=>TooltipHandlerWithPaint,LS:()=>defaultRenderTooltipSerie,Fl:()=>tooltip_formatValue});var src=__webpack_require__("./node_modules/vega-lite/build/src/index.js"),vega_util_module=__webpack_require__("./node_modules/vega-util/build/vega-util.module.js");function stringify(obj,maxDepth){return JSON.stringify(obj,function replacer(maxDepth){const stack=[];return function(key,value){if("object"!=typeof value||null===value)return value;const pos=stack.indexOf(this)+1;return stack.length=pos,stack.length>maxDepth?"[Object]":stack.indexOf(value)>=0?"[Circular]":(stack.push(value),value)}}(maxDepth))}var defaultStyle="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const EL_ID="vg-tooltip-element",DEFAULT_OPTIONS={offsetX:10,offsetY:10,id:EL_ID,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function escapeHTML(value){return String(value).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function formatValue(value,valueToHtml,maxDepth){if((0,vega_util_module.cy)(value))return`[${value.map((v=>valueToHtml((0,vega_util_module.Kg)(v)?v:stringify(v,maxDepth)))).join(", ")}]`;if((0,vega_util_module.Gv)(value)){let content="";const _a=value,{title,image}=_a,rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}(_a,["title","image"]);title&&(content+=`<h2>${valueToHtml(title)}</h2>`),image&&(content+=`<img src="${valueToHtml(image)}">`);const keys=Object.keys(rest);if(keys.length>0){content+="<table>";for(const key of keys){let val=rest[key];void 0!==val&&((0,vega_util_module.Gv)(val)&&(val=stringify(val,maxDepth)),content+=`<tr><td class="key">${valueToHtml(key)}:</td><td class="value">${valueToHtml(val)}</td></tr>`)}content+="</table>"}return content||"{}"}return valueToHtml(value)}};class Handler{constructor(options){this.options=Object.assign(Object.assign({},DEFAULT_OPTIONS),options);const elementId=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const style=document.createElement("style");style.setAttribute("id",this.options.styleId),style.innerHTML=function createDefaultStyle(id){if(!/^[A-Za-z]+[-:.\w]*$/.test(id))throw new Error("Invalid HTML ID");return defaultStyle.toString().replace(EL_ID,id)}(elementId);const head=document.head;head.childNodes.length>0?head.insertBefore(style,head.childNodes[0]):head.appendChild(style)}}tooltipHandler(handler,event,item,value){var _a;this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el));if((null!==(_a=document.fullscreenElement)&&void 0!==_a?_a:document.body).appendChild(this.el),null==value||""===value)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(value,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x,y}=function calculatePosition(event,tooltipBox,offsetX,offsetY){let x=event.clientX+offsetX;x+tooltipBox.width>window.innerWidth&&(x=+event.clientX-offsetX-tooltipBox.width);let y=event.clientY+offsetY;return y+tooltipBox.height>window.innerHeight&&(y=+event.clientY-offsetY-tooltipBox.height),{x,y}}(event,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${y}px; left: ${x}px`)}}var theme=__webpack_require__("./src/lib/style/theme.ts"),_excluded=["title","image"];function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function defaultRenderTooltipSerie(_ref){var{color,isLineDashed,name,value,key}=_ref;return'<tr>\n    <td class="color">\n    '.concat(void 0!==color?"<span style='background: ".concat(isLineDashed?"repeating-linear-gradient(to right,".concat(color," 0,").concat(color," ").concat(theme.YK.sp1,",transparent ").concat(theme.YK.sp1,",transparent ").concat(theme.YK.sp2,")"):color,";width: ").concat(theme.YK.sp8,";height:").concat(theme.YK.sp2,";display: inline-block;vertical-align: middle;'></span>"):"",'\n    </td>\n    <td class="key" style="text-align: left;">\n        ').concat(name,'\n    </td>\n    <td class="value" style="text-align: right;">\n      ').concat(value,"\n    </td>\n  </tr>")}class TooltipHandlerWithPaint extends Handler{constructor(options,onHover){super(options),this.prevCall=this.call,this.onHover=onHover,this.call=this.newCall.bind(this)}newCall(handler,event,item,value){item&&this.onHover&&JSON.stringify(value)!==JSON.stringify(this.value)&&this.onHover(item.datum.datum),this.handler=handler,this.event=event,this.item=item,this.value=value,this.prevCall(handler,event,item,value)}paint(){this.prevCall(this.handler,this.event,this.item,this.value)}}function tooltip_formatValue(series,customizedColorRange,colorRange,unitLabel,yAxisType){var renderTooltipSerie=arguments.length>5&&void 0!==arguments[5]?arguments[5]:defaultRenderTooltipSerie;return(value,valueToHtml,maxDepth)=>{if((0,vega_util_module.cy)(value))return"[".concat(value.map((v=>valueToHtml((0,vega_util_module.Kg)(v)?v:(0,src.stringify)(v,maxDepth)))).join(", "),"]");if((0,vega_util_module.Gv)(value)){var content="",{title,image}=value,rest=_objectWithoutProperties(value,_excluded);title&&(content+='<h2 style="text-align: center;">'.concat(valueToHtml(title),"</h2>")),image&&(content+='<img src="'.concat(valueToHtml(image),'">'));var keys=Object.keys(rest);if(keys.length>0){content+="<table>";var _loop=function _loop(key){var val=rest[key];if(void 0===val)return 1;(0,vega_util_module.Gv)(val)&&(val=(0,src.stringify)(val,maxDepth));var currentSerie=series.find((serie=>serie.getTooltipLabel(serie.metricPrefix,serie.resource)===key)),currentSerieIndex=series.findIndex((serie=>serie.getTooltipLabel(serie.metricPrefix,serie.resource)===key)),serieIndex="symmetrical"!==yAxisType||customizedColorRange.length?currentSerieIndex:[...new Set(series.map((serie=>serie.resource)))].findIndex((serieResource=>serieResource===(currentSerie?currentSerie.resource:null))),serieColorRange=customizedColorRange.length?customizedColorRange:colorRange;content+=renderTooltipSerie({key,color:-1!==serieIndex?serieColorRange[serieIndex]:void 0,isLineDashed:-1!==serieIndex?series[serieIndex].isLineDashed:void 0,name:valueToHtml(key),value:"NaN"!==val?"".concat(valueToHtml(val)," ").concat(unitLabel):"-",unitLabel},value)};for(var key of keys)_loop(key);content+="</table>"}return content||"{}"}return valueToHtml(value)}}},"./src/lib/components/vegachartv2/SyncedCursorCharts.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{IF:()=>SyncedCursorCharts,Lq:()=>SyncedCursorChartsContext,UO:()=>useCursorX});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),SyncedCursorChartsContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(null),useCursorX=()=>{var contextValue=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(SyncedCursorChartsContext);return null===contextValue&&console.error("Can't use useCursorX() outside SyncedCursorCharts"),contextValue};function SyncedCursorCharts(_ref){var{children}=_ref,[cursorX,setCursorX]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(SyncedCursorChartsContext.Provider,{value:{cursorX,setCursorX},children})}SyncedCursorCharts.displayName="SyncedCursorCharts";try{SyncedCursorCharts.displayName="SyncedCursorCharts",SyncedCursorCharts.__docgenInfo={description:"",displayName:"SyncedCursorCharts",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/lib/components/vegachartv2/SyncedCursorCharts.tsx#SyncedCursorCharts"]={docgenInfo:SyncedCursorCharts.__docgenInfo,name:"SyncedCursorCharts",path:"src/lib/components/vegachartv2/SyncedCursorCharts.tsx#SyncedCursorCharts"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/components/vegachartv2/VegaChartV2.component.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{sD:()=>VegaChart});var _templateObject,_templateObject2,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),vega__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/vega/build/vega.module.js"),vega_embed__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/vega-embed/build/src/embed.js"),styled_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_SyncedCursorCharts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/lib/components/vegachartv2/SyncedCursorCharts.tsx"),_linetemporalchart_tooltip__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/lib/components/linetemporalchart/tooltip/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:String(i)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _taggedTemplateLiteral(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var BOTTOM="bottom",VegaTooltipTheme=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.DU)(_templateObject||(_templateObject=_taggedTemplateLiteral(["\n  #vg-tooltip-element.vg-tooltip.custom-theme {\n    ","\n    \n  }\n"])),(props=>{var{theme}=props;return(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.AH)(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["\n        padding: 8px;\n        position: fixed;\n        z-index: 1000;\n        width: calc(100vw / 6);\n        font-family: 'Lato';\n        font-size: 12px;\n        border-radius: 3px;\n        box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n        color: ",";\n        background-color: ",";\n        border: 1px solid ",";\n        // customize the title\n        h2 {\n          color: ",";\n          margin-bottom: 10px;\n          font-size: 12px;\n        }\n        table {\n          width: 100%;\n        }\n        table tr td.key {\n          color: ",";\n        }\n      "])),theme.textPrimary,theme.backgroundLevel1,theme.border,theme.textPrimary,theme.textSecondary)}));function VegaChartInternal(_ref,ref){var{spec,tooltipPosition=BOTTOM,theme="custom",formatTooltip,onHover}=_ref,{cursorX,setCursorX}=(0,_SyncedCursorCharts__WEBPACK_IMPORTED_MODULE_5__.UO)(),currentTheme=(0,styled_components__WEBPACK_IMPORTED_MODULE_4__.DP)(),themeConfig={config:{background:"transparent",axis:{labelColor:currentTheme.textSecondary,titleColor:currentTheme.textSecondary,grid:!1,domainColor:"transparent"},title:{color:currentTheme.textPrimary,font:"Lato"},view:{stroke:currentTheme.border,strokeWidth:.5,fill:currentTheme.backgroundLevel1},header:{labelColor:currentTheme.textPrimary},text:{color:currentTheme.textPrimary,font:"Lato"},legend:{labelColor:currentTheme.textSecondary}}},themedSpec=_objectSpread(_objectSpread({},spec),themeConfig),vegaInstance=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),vegaDOMInstance=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),tooltipOptions={theme,formatTooltip};"top"===tooltipPosition&&(tooltipOptions={theme,offsetX:-85,offsetY:-140,formatTooltip});var tooltipHandler=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>new _linetemporalchart_tooltip__WEBPACK_IMPORTED_MODULE_6__.CI(tooltipOptions,onHover)),[theme]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{var isMounted=!0;return vegaDOMInstance&&vegaDOMInstance.current&&(0,vega_embed__WEBPACK_IMPORTED_MODULE_2__.Ay)(vegaDOMInstance.current,themedSpec,{renderer:"svg",tooltip:tooltipHandler.call,actions:!1}).then((result=>{vegaInstance.current=result;var view=result.view;ref&&(ref.current=view),_SyncedCursorCharts__WEBPACK_IMPORTED_MODULE_5__.Lq&&view&&(view.addEventListener("mouseover",(function(event,item){var currentTime=item&&item.datum&&item.datum.datum&&item.datum.datum.timestamp;currentTime&&setCursorX(currentTime)})),view.addEventListener("mouseleave",(function(event,item){setCursorX(0)})))})).catch((function(){isMounted&&console.error(...arguments)})),()=>{isMounted=!1,vegaInstance.current&&vegaInstance.current.view.finalize()}}),[vegaDOMInstance,currentTheme]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{if(vegaInstance.current){var view=vegaInstance.current.view;tooltipHandler.options.formatTooltip=formatTooltip,tooltipHandler.onHover=onHover,view.tooltip(tooltipHandler.call).run(),tooltipHandler.paint()}}),[formatTooltip,vegaInstance,onHover]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{if(vegaInstance.current){var view=vegaInstance.current.view,changeset=vega__WEBPACK_IMPORTED_MODULE_1__.changeset().remove((()=>!0)).insert(themedSpec.data.values);view.change("source_0",changeset).runAsync().then((()=>{view.resize().runAsync()}))}}),[JSON.stringify(themedSpec.data.values),vegaInstance]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{if(vegaInstance.current&&themedSpec.params){var view=vegaInstance.current.view;themedSpec.params.find((param=>"cursorX"===param.name)).value&&cursorX?(view.signal("cursorX",themedSpec.params.find((param=>"cursorX"===param.name)).value).run(),view.signal("isCursorDisplayed",!0).run()):(view.signal("cursorX",themedSpec&&themedSpec.data&&themedSpec.data.values&&themedSpec.data.values[0]&&themedSpec.data.values[0].timestamp||Date.now()).run(),view.signal("isCursorDisplayed",!1).run())}}),[JSON.stringify(themedSpec),vegaInstance]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"sc-vegachart",ref:vegaDOMInstance,style:{width:"100%"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(VegaTooltipTheme,{})})}VegaChartInternal.displayName="VegaChartInternal";var VegaChart=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(VegaChartInternal);try{VegaChart.displayName="VegaChart",VegaChart.__docgenInfo={description:"",displayName:"VegaChart",props:{spec:{defaultValue:null,description:"",name:"spec",required:!0,type:{name:"Record<string, any>"}},tooltipPosition:{defaultValue:null,description:"",name:"tooltipPosition",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'}]}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"enum",value:[{value:'"custom"'},{value:'"dark"'},{value:'"light"'}]}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},onHover:{defaultValue:null,description:"",name:"onHover",required:!1,type:{name:"((dataPoint: any) => void)"}},formatTooltip:{defaultValue:null,description:"",name:"formatTooltip",required:!1,type:{name:"((value: any, valueToHtml: (value: any) => string, maxDepth: number) => string)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/lib/components/vegachartv2/VegaChartV2.component.tsx#VegaChart"]={docgenInfo:VegaChart.__docgenInfo,name:"VegaChart",path:"src/lib/components/vegachartv2/VegaChartV2.component.tsx#VegaChart"})}catch(__react_docgen_typescript_loader_error){}}}]);